(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     80037,       1730]
NotebookOptionsPosition[     78013,       1696]
NotebookOutlinePosition[     78634,       1717]
CellTagsIndexPosition[     78591,       1714]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "Define the metric, magnetic field, and parameters.\nThe covariant metric is \
denoted as ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "16e69b19-fd96-4f17-9eb2-3b8830d1f56a"],
 ".\nNote: Only the equatorial-plane metric needs to be defined, as the \
Novikov-Thorne accretion disk is geometrically thin and confined to the \
equatorial plane.\n\[Beta] and ",
 StyleBox["a",
  FontSlant->"Italic"],
 " denote the magnetic field strength and spin parameter, respectively.\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", "t"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "030a3990-b66e-4fbd-b286-39a4d922b82f"],
 " and",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    SubscriptBox["A", "\[Phi]"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "45b4223b-244b-463c-86d7-f4bce83d8d10"],
 " represent the components of the magnetic field.\n",
 StyleBox["Important: First, execute the initial module. Then, input the \
coordinates of the intersection point of the two resulting curves into the \
designated positions in the second module before running the entire NOTEBOOK.",
  FontSize->16,
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.976519809697038*^9, 3.9765200572328815`*^9}, {
   3.9765205288678274`*^9, 3.9765205840120897`*^9}, {3.9765215004521904`*^9, 
   3.9765215507791986`*^9}, {3.976522256069538*^9, 3.9765223777573557`*^9}, 
   3.9765224088382473`*^9, {3.9765224831299973`*^9, 3.9765225141908216`*^9}, 
   3.976522645470033*^9, {3.976523640091977*^9, 
   3.976523644021186*^9}},ExpressionUUID->"8d341e95-62d5-4dcb-9d0b-\
20b99442642a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Beta]", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reh", "=", 
   RowBox[{"1", "+", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", "-", 
      SuperscriptBox["a", "2"]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["g", "tt"], "=", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", "/", "r"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["g", "rr"], "=", 
   RowBox[{
    SuperscriptBox["r", "2"], "/", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], "-", 
      RowBox[{"2", "\[Times]", "r"}], "+", 
      SuperscriptBox["a", "2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["g", "\[Theta]\[Theta]"], "=", 
   SuperscriptBox["r", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["g", "\[Phi]\[Phi]"], "=", 
   RowBox[{
    SuperscriptBox["r", "2"], "+", 
    SuperscriptBox["a", "2"], "+", 
    RowBox[{"2", "\[Times]", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["a", "2"], "/", "r"}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["g", "t\[Phi]"], "=", 
   RowBox[{
    RowBox[{"-", "2"}], "\[Times]", 
    RowBox[{"(", 
     RowBox[{"a", "/", "r"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["g", "\[Phi]t"], "=", 
   SubscriptBox["g", "t\[Phi]"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     SubscriptBox["g", "\[Phi]\[Phi]"], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["g", "tt"], "\[Times]", 
        SubscriptBox["g", "\[Phi]\[Phi]"]}], "-", 
       RowBox[{
        SubscriptBox["g", "t\[Phi]"], "\[Times]", 
        SubscriptBox["g", "t\[Phi]"]}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     SubscriptBox["g", "t\[Phi]"], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["g", "tt"], "\[Times]", 
        SubscriptBox["g", "\[Phi]\[Phi]"]}], "-", 
       RowBox[{
        SubscriptBox["g", "t\[Phi]"], "\[Times]", 
        SubscriptBox["g", "t\[Phi]"]}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f3", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     SubscriptBox["g", "tt"], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["g", "tt"], "\[Times]", 
        SubscriptBox["g", "\[Phi]\[Phi]"]}], "-", 
       RowBox[{
        SubscriptBox["g", "t\[Phi]"], "\[Times]", 
        SubscriptBox["g", "t\[Phi]"]}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covariant", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["g", "tt"], ",", "0", ",", "0", ",", 
       SubscriptBox["g", "t\[Phi]"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       SubscriptBox["g", "rr"], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       SubscriptBox["g", "\[Theta]\[Theta]"], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["g", "\[Phi]t"], ",", "0", ",", "0", ",", 
       SubscriptBox["g", "\[Phi]\[Phi]"]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covariance", "=", 
   RowBox[{"Inverse", "[", "covariant", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"MatrixForm", "[", "covariant", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"MatrixForm", "[", "covariance", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["A", "t"], "=", 
   RowBox[{"a", "\[Times]", "\[Beta]", "\[Times]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", "/", "r"}], "-", "1"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["A", "\[Phi]"], "=", 
   RowBox[{"\[Beta]", "\[Times]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         SuperscriptBox["a", "2"]}], ")"}], "/", "2"}], "-", 
      RowBox[{
       SuperscriptBox["a", "2"], "/", "r"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a1", "=", 
   RowBox[{"covariance", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a2", "=", 
   RowBox[{
    RowBox[{"2", "\[Times]", "P", "\[Times]", 
     RowBox[{"covariance", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "4"}], "]"}], "]"}]}], "-", 
    RowBox[{"2", "\[Times]", 
     RowBox[{"covariance", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "4"}], "]"}], "]"}], "\[Times]", 
     SubscriptBox["A", "\[Phi]"]}], "-", 
    RowBox[{"2", "\[Times]", 
     SubscriptBox["A", "t"], "\[Times]", 
     RowBox[{"covariance", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"covariance", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Times]", 
     SubscriptBox["A", "t"], "\[Times]", 
     SubscriptBox["A", "t"]}], "+", 
    RowBox[{
     RowBox[{"covariance", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "4"}], "]"}], "]"}], "\[Times]", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"P", "-", 
        SubscriptBox["A", "\[Phi]"]}], ")"}], "2"]}], "-", 
    RowBox[{"2", "\[Times]", 
     RowBox[{"covariance", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "4"}], "]"}], "]"}], "\[Times]", "P", "\[Times]", 
     SubscriptBox["A", "t"]}], "+", 
    RowBox[{"2", "\[Times]", 
     RowBox[{"covariance", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "4"}], "]"}], "]"}], "\[Times]", 
     SubscriptBox["A", "t"], "\[Times]", 
     SubscriptBox["A", "\[Phi]"]}], "+", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"veff", "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "\[Times]", "a1"}], ")"}]}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "a2"}], "+", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"a2", "\[Times]", "a2"}], "-", 
        RowBox[{"4", "\[Times]", "a1", "\[Times]", "a3"}]}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d1", "=", 
   RowBox[{"D", "[", 
    RowBox[{"veff", ",", "r"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d2", "=", 
   RowBox[{"D", "[", 
    RowBox[{"d1", ",", "r"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dveff", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"d1", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "->", "x"}], ",", 
      RowBox[{"P", "->", "y"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ddveff", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"d2", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "->", "x"}], ",", 
      RowBox[{"P", "->", "y"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot", "=", 
  RowBox[{"ContourPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dveff", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "==", "0"}], ",", 
      RowBox[{
       RowBox[{"ddveff", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "==", "0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"reh", "+", "0.001"}], ",", "10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "0", ",", "10"}], "}"}], ",", 
    RowBox[{"FrameLabel", "->", 
     RowBox[{"{", 
      RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
    RowBox[{"ContourStyle", "->", 
     RowBox[{"{", 
      RowBox[{"Red", ",", "Blue"}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "->", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\[PartialD]\!\(\*SubscriptBox[\(v\), \
\(eff\)]\)/\[PartialD]r=0\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(\[PartialD]\), \(2\)]\)\!\(\*SubscriptBox[\
\(v\), \(eff\)]\)/\[PartialD]\!\(\*SuperscriptBox[\(r\), \(2\)]\)=0\>\""}], 
      "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.9571667242857456`*^9, 3.957166779129676*^9}, {
   3.957166831634246*^9, 3.957166859348877*^9}, {3.957166989411211*^9, 
   3.957167008200284*^9}, {3.9571670513388357`*^9, 3.9571671273218117`*^9}, {
   3.9571671758101606`*^9, 3.957167292265072*^9}, {3.957167389706868*^9, 
   3.9571674886639767`*^9}, {3.957167520963458*^9, 3.9571675463169775`*^9}, {
   3.9571676858816566`*^9, 3.957167846126298*^9}, {3.957167915140493*^9, 
   3.957167939644196*^9}, {3.9571679850308456`*^9, 3.957167991677231*^9}, {
   3.957168049845221*^9, 3.957168052268364*^9}, {3.957168096102919*^9, 
   3.957168179388928*^9}, {3.9571683117917247`*^9, 3.957168329173957*^9}, {
   3.957168478907979*^9, 3.9571685912565436`*^9}, {3.9571687217190385`*^9, 
   3.9571687242389355`*^9}, {3.9571687803767767`*^9, 
   3.9571688639156613`*^9}, {3.9571689893729515`*^9, 
   3.9571690179135404`*^9}, {3.957169088865106*^9, 3.957169104365032*^9}, {
   3.9571693734272175`*^9, 3.957169465624623*^9}, {3.957169544136488*^9, 
   3.9571695495144215`*^9}, {3.957169830015744*^9, 3.957169842749343*^9}, {
   3.957169998902274*^9, 3.957170133887292*^9}, {3.9571701783610973`*^9, 
   3.9571702557026186`*^9}, {3.957170510874618*^9, 3.957170548159157*^9}, {
   3.9571707534935226`*^9, 3.9571707541519337`*^9}, {3.957171374272787*^9, 
   3.9571713763886275`*^9}, {3.9571715203371563`*^9, 
   3.9571715344963923`*^9}, {3.9571715646201124`*^9, 3.957171641991712*^9}, {
   3.957171719182576*^9, 3.957171749907152*^9}, {3.957171804228082*^9, 
   3.957171806569125*^9}, 3.9571718704746275`*^9, {3.957171952003688*^9, 
   3.9571719521385813`*^9}, {3.9571720638977423`*^9, 3.957172080422122*^9}, {
   3.9571733535376067`*^9, 3.957173358600973*^9}, {3.9571733919919386`*^9, 
   3.957173395759247*^9}, {3.957173505958381*^9, 3.957173524297681*^9}, {
   3.95717358186709*^9, 3.9571736712013893`*^9}, {3.957173764877982*^9, 
   3.9571737896319*^9}, {3.9571738198388047`*^9, 3.957173847715577*^9}, {
   3.9571738889563417`*^9, 3.957173889764689*^9}, {3.957174013820868*^9, 
   3.957174019475267*^9}, {3.9571740532704926`*^9, 3.95717405380604*^9}, {
   3.957174131225661*^9, 3.9571741402483516`*^9}, {3.95717475593443*^9, 
   3.9571747563486533`*^9}, {3.9572145445003977`*^9, 
   3.9572145468267727`*^9}, {3.9572182526848245`*^9, 
   3.9572182626798477`*^9}, {3.9572192861122446`*^9, 3.957219382190755*^9}, {
   3.95722557672433*^9, 3.9572255791031694`*^9}, {3.9572302045605974`*^9, 
   3.957230204784874*^9}, {3.9572325230281677`*^9, 3.9572325404044013`*^9}, {
   3.9574242320109477`*^9, 3.9574242364407454`*^9}, {3.9574680930630817`*^9, 
   3.9574680934483833`*^9}, {3.9574758709069223`*^9, 3.957475871432787*^9}, {
   3.9575051986562324`*^9, 3.9575051990335703`*^9}, {3.9575172118428335`*^9, 
   3.95751721217233*^9}, {3.957569655074523*^9, 3.95756965529618*^9}, {
   3.9575760837184067`*^9, 3.9575760840372243`*^9}, {3.957643608265041*^9, 
   3.957643608853529*^9}, {3.957661929304307*^9, 3.9576619294884806`*^9}, {
   3.957721645443865*^9, 3.957721645829754*^9}, {3.9577413054930267`*^9, 
   3.957741305593648*^9}, {3.9577602191452217`*^9, 3.9577602229993773`*^9}, 
   3.957760258259962*^9, {3.9578075583756676`*^9, 3.9578075613754807`*^9}, {
   3.9578324891796303`*^9, 3.9578324894212875`*^9}, {3.9578514428198256`*^9, 
   3.9578514430985627`*^9}, {3.957905901535838*^9, 3.9579059034720993`*^9}, {
   3.957906046138204*^9, 3.9579060466058936`*^9}, {3.958202069783778*^9, 
   3.9582020736733665`*^9}, {3.973583285798888*^9, 3.9735832859059296`*^9}, {
   3.973583909521531*^9, 3.9735839095730333`*^9}, {3.973584328224471*^9, 
   3.973584328280898*^9}, {3.9735846079482803`*^9, 3.9735846089213524`*^9}, {
   3.9735846687085967`*^9, 3.973584725944625*^9}, {3.973584998660328*^9, 
   3.9735850015571785`*^9}, {3.974262523684062*^9, 3.974262550661206*^9}, 
   3.9750562772156506`*^9, {3.975056804411849*^9, 3.9750568047048273`*^9}, {
   3.975056919491023*^9, 3.9750569260589643`*^9}, {3.9750631814193254`*^9, 
   3.9750631820609713`*^9}, {3.975093630689657*^9, 3.975093630824641*^9}, {
   3.9751071170454698`*^9, 3.975107117310058*^9}, {3.975132909054817*^9, 
   3.9751329091470785`*^9}, {3.975136841479034*^9, 3.9751368524248066`*^9}, {
   3.975141445619957*^9, 3.975141446140789*^9}, {3.9751690125293283`*^9, 
   3.9751690133192434`*^9}, {3.9751763069345417`*^9, 
   3.9751763072459717`*^9}, {3.9752126875761166`*^9, 3.975212687685747*^9}, {
   3.9752178205154505`*^9, 3.9752178229638186`*^9}, {3.975226663728011*^9, 
   3.9752266642149982`*^9}, {3.9752326243530655`*^9, 3.975232624510539*^9}, {
   3.975261920990927*^9, 3.975261921201217*^9}, {3.9752691461795044`*^9, 
   3.9752691484359083`*^9}, {3.9752749535158467`*^9, 
   3.9752749538766613`*^9}, {3.975284308227299*^9, 3.975284308609645*^9}, {
   3.975289412002921*^9, 3.9752894121534176`*^9}, {3.975295623075131*^9, 
   3.975295625062713*^9}, {3.975305940609538*^9, 3.9753059407878027`*^9}, {
   3.975311698281192*^9, 3.9753117031001773`*^9}, {3.975317226436745*^9, 
   3.97531722682977*^9}, {3.975350326721467*^9, 3.9753503271147413`*^9}, {
   3.9753607710171084`*^9, 3.9753607740525165`*^9}, {3.9753714224664755`*^9, 
   3.975371422574362*^9}, {3.9753951606104484`*^9, 3.9753951630943403`*^9}, {
   3.975412664504738*^9, 3.9754126648703313`*^9}, {3.975469919904792*^9, 
   3.9754699199247527`*^9}, {3.97547588097383*^9, 3.9754758812096233`*^9}, {
   3.9755267637040195`*^9, 3.9755267637587433`*^9}, {3.9755316672832875`*^9, 
   3.975531682266079*^9}, {3.9755371953194246`*^9, 3.975537195655155*^9}, {
   3.9755439474381576`*^9, 3.975543947598734*^9}, {3.975555537929798*^9, 
   3.975555538336054*^9}, {3.9755616894624295`*^9, 3.975561689524208*^9}, {
   3.975568392841753*^9, 3.975568394963889*^9}, {3.9755724956415052`*^9, 
   3.975572496989444*^9}, {3.975603578376444*^9, 3.9756035784921093`*^9}, {
   3.975609054956176*^9, 3.9756090551512403`*^9}, {3.9756394668819785`*^9, 
   3.975639467009555*^9}, {3.9756444651832066`*^9, 3.975644469452668*^9}, {
   3.97564840152319*^9, 3.9756484022096863`*^9}, {3.975653964662733*^9, 
   3.9756539647334957`*^9}, {3.9756587226689987`*^9, 
   3.9756587229332247`*^9}, {3.975679866077001*^9, 3.9756798662524147`*^9}, {
   3.9765197898874297`*^9, 3.9765198004337645`*^9}, {3.976520084889516*^9, 
   3.976520085361278*^9}, {3.9765229900648727`*^9, 
   3.976522990562402*^9}},ExpressionUUID->"3c374082-1d52-412d-8ef2-\
d0bf6ce40da6"],

Cell[TextData[{
 "Define the ISCO radius and the outer boundary of the accretion disk.\n\
Assign the coordinates of the intersection point between the red curve (",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    RowBox[{"\[PartialD]", 
     SubscriptBox["v", "eff"]}], "/", 
    RowBox[{"\[PartialD]", "r"}]}], "=", "0"}]],
  CellChangeTimes->{{3.9571667242857456`*^9, 3.957166779129676*^9}, {
    3.957166831634246*^9, 3.957166859348877*^9}, {3.957166989411211*^9, 
    3.957167008200284*^9}, {3.9571670513388357`*^9, 3.9571671273218117`*^9}, {
    3.9571671758101606`*^9, 3.957167292265072*^9}, {3.957167389706868*^9, 
    3.9571674886639767`*^9}, {3.957167520963458*^9, 3.9571675463169775`*^9}, {
    3.9571676858816566`*^9, 3.957167846126298*^9}, {3.957167915140493*^9, 
    3.957167939644196*^9}, {3.9571679850308456`*^9, 3.957167991677231*^9}, {
    3.957168049845221*^9, 3.957168052268364*^9}, {3.957168096102919*^9, 
    3.957168179388928*^9}, {3.9571683117917247`*^9, 3.957168329173957*^9}, {
    3.957168478907979*^9, 3.9571685912565436`*^9}, {3.9571687217190385`*^9, 
    3.9571687242389355`*^9}, {3.9571687803767767`*^9, 
    3.9571688639156613`*^9}, {3.9571689893729515`*^9, 
    3.9571690179135404`*^9}, {3.957169088865106*^9, 3.957169104365032*^9}, {
    3.9571693734272175`*^9, 3.957169465624623*^9}, {3.957169544136488*^9, 
    3.9571695495144215`*^9}, {3.957169830015744*^9, 3.957169842749343*^9}, {
    3.957169998902274*^9, 3.957170133887292*^9}, {3.9571701783610973`*^9, 
    3.9571702557026186`*^9}, {3.957170510874618*^9, 3.957170548159157*^9}, {
    3.9571707534935226`*^9, 3.9571707541519337`*^9}, {3.957171374272787*^9, 
    3.9571713763886275`*^9}, {3.9571715203371563`*^9, 
    3.9571715344963923`*^9}, {3.9571715646201124`*^9, 3.957171641991712*^9}, {
    3.957171719182576*^9, 3.957171749907152*^9}, {3.957171804228082*^9, 
    3.957171806569125*^9}, 3.9571718704746275`*^9, {3.957171952003688*^9, 
    3.9571719521385813`*^9}, {3.9571720638977423`*^9, 3.957172080422122*^9}, {
    3.9571733535376067`*^9, 3.957173358600973*^9}, {3.9571733919919386`*^9, 
    3.957173395759247*^9}, {3.957173505958381*^9, 3.957173524297681*^9}, {
    3.95717358186709*^9, 3.9571736712013893`*^9}, {3.957173764877982*^9, 
    3.9571737896319*^9}, {3.9571738198388047`*^9, 3.957173847715577*^9}, {
    3.9571738889563417`*^9, 3.957173889764689*^9}, {3.957174013820868*^9, 
    3.957174019475267*^9}, {3.9571740532704926`*^9, 3.95717405380604*^9}, {
    3.957174131225661*^9, 3.9571741402483516`*^9}, {3.95717475593443*^9, 
    3.9571747563486533`*^9}, {3.9572145445003977`*^9, 
    3.9572145468267727`*^9}, {3.9572182526848245`*^9, 
    3.9572182626798477`*^9}, {3.9572192861122446`*^9, 3.957219382190755*^9}, {
    3.95722557672433*^9, 3.9572255791031694`*^9}, {3.9572302045605974`*^9, 
    3.957230204784874*^9}, {3.9572325230281677`*^9, 3.9572325404044013`*^9}, {
    3.9574242320109477`*^9, 3.9574242364407454`*^9}, {3.9574680930630817`*^9, 
    3.9574680934483833`*^9}, {3.9574758709069223`*^9, 3.957475871432787*^9}, {
    3.9575051986562324`*^9, 3.9575051990335703`*^9}, {3.9575172118428335`*^9, 
    3.95751721217233*^9}, {3.957569655074523*^9, 3.95756965529618*^9}, {
    3.9575760837184067`*^9, 3.9575760840372243`*^9}, {3.957643608265041*^9, 
    3.957643608853529*^9}, {3.957661929304307*^9, 3.9576619294884806`*^9}, {
    3.957721645443865*^9, 3.957721645829754*^9}, {3.9577413054930267`*^9, 
    3.957741305593648*^9}, {3.9577602191452217`*^9, 3.9577602229993773`*^9}, 
    3.957760258259962*^9, {3.9578075583756676`*^9, 3.9578075613754807`*^9}, {
    3.9578324891796303`*^9, 3.9578324894212875`*^9}, {3.9578514428198256`*^9, 
    3.9578514430985627`*^9}, {3.957905901535838*^9, 3.9579059034720993`*^9}, {
    3.957906046138204*^9, 3.9579060466058936`*^9}, {3.958202069783778*^9, 
    3.9582020736733665`*^9}, {3.973583285798888*^9, 3.9735832859059296`*^9}, {
    3.973583909521531*^9, 3.9735839095730333`*^9}, {3.973584328224471*^9, 
    3.973584328280898*^9}, {3.9735846079482803`*^9, 3.9735846089213524`*^9}, {
    3.9735846687085967`*^9, 3.973584725944625*^9}, {3.973584998660328*^9, 
    3.9735850015571785`*^9}, {3.974262523684062*^9, 3.974262550661206*^9}, 
    3.9750562772156506`*^9, {3.975056804411849*^9, 3.9750568047048273`*^9}, {
    3.975056919491023*^9, 3.9750569260589643`*^9}, {3.9750631814193254`*^9, 
    3.9750631820609713`*^9}, {3.975093630689657*^9, 3.975093630824641*^9}, {
    3.9751071170454698`*^9, 3.975107117310058*^9}, {3.975132909054817*^9, 
    3.9751329091470785`*^9}, {3.975136841479034*^9, 3.9751368524248066`*^9}, {
    3.975141445619957*^9, 3.975141446140789*^9}, {3.9751690125293283`*^9, 
    3.9751690133192434`*^9}, {3.9751763069345417`*^9, 
    3.9751763072459717`*^9}, {3.9752126875761166`*^9, 3.975212687685747*^9}, {
    3.9752178205154505`*^9, 3.9752178229638186`*^9}, {3.975226663728011*^9, 
    3.9752266642149982`*^9}, {3.9752326243530655`*^9, 3.975232624510539*^9}, {
    3.975261920990927*^9, 3.975261921201217*^9}, {3.9752691461795044`*^9, 
    3.9752691484359083`*^9}, {3.9752749535158467`*^9, 
    3.9752749538766613`*^9}, {3.975284308227299*^9, 3.975284308609645*^9}, {
    3.975289412002921*^9, 3.9752894121534176`*^9}, {3.975295623075131*^9, 
    3.975295625062713*^9}, {3.975305940609538*^9, 3.9753059407878027`*^9}, {
    3.975311698281192*^9, 3.9753117031001773`*^9}, {3.975317226436745*^9, 
    3.97531722682977*^9}, {3.975350326721467*^9, 3.9753503271147413`*^9}, {
    3.9753607710171084`*^9, 3.9753607740525165`*^9}, {3.9753714224664755`*^9, 
    3.975371422574362*^9}, {3.9753951606104484`*^9, 3.9753951630943403`*^9}, {
    3.975412664504738*^9, 3.9754126648703313`*^9}, {3.975469919904792*^9, 
    3.9754699199247527`*^9}, {3.97547588097383*^9, 3.9754758812096233`*^9}, {
    3.9755267637040195`*^9, 3.9755267637587433`*^9}, {3.9755316672832875`*^9, 
    3.975531682266079*^9}, {3.9755371953194246`*^9, 3.975537195655155*^9}, {
    3.9755439474381576`*^9, 3.975543947598734*^9}, {3.975555537929798*^9, 
    3.975555538336054*^9}, {3.9755616894624295`*^9, 3.975561689524208*^9}, {
    3.975568392841753*^9, 3.975568394963889*^9}, {3.9755724956415052`*^9, 
    3.975572496989444*^9}, {3.975603578376444*^9, 3.9756035784921093`*^9}, {
    3.975609054956176*^9, 3.9756090551512403`*^9}, {3.9756394668819785`*^9, 
    3.975639467009555*^9}, {3.9756444651832066`*^9, 3.975644469452668*^9}, {
    3.97564840152319*^9, 3.9756484022096863`*^9}, {3.975653964662733*^9, 
    3.9756539647334957`*^9}, {3.9756587226689987`*^9, 
    3.9756587229332247`*^9}, {3.975679866077001*^9, 3.9756798662524147`*^9}, {
    3.9765197898874297`*^9, 3.9765198004337645`*^9}, {3.976520084889516*^9, 
    3.976520085361278*^9}},ExpressionUUID->
  "aa6eb558-480e-42d1-8705-284a6a5c430d"],
 ") and the blue curve (",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["\[PartialD]", "2"], 
     SubscriptBox["v", "eff"]}], "/", 
    RowBox[{"\[PartialD]", 
     SuperscriptBox["r", "2"]}]}], "=", "0"}]],
  CellChangeTimes->{{3.9571667242857456`*^9, 3.957166779129676*^9}, {
    3.957166831634246*^9, 3.957166859348877*^9}, {3.957166989411211*^9, 
    3.957167008200284*^9}, {3.9571670513388357`*^9, 3.9571671273218117`*^9}, {
    3.9571671758101606`*^9, 3.957167292265072*^9}, {3.957167389706868*^9, 
    3.9571674886639767`*^9}, {3.957167520963458*^9, 3.9571675463169775`*^9}, {
    3.9571676858816566`*^9, 3.957167846126298*^9}, {3.957167915140493*^9, 
    3.957167939644196*^9}, {3.9571679850308456`*^9, 3.957167991677231*^9}, {
    3.957168049845221*^9, 3.957168052268364*^9}, {3.957168096102919*^9, 
    3.957168179388928*^9}, {3.9571683117917247`*^9, 3.957168329173957*^9}, {
    3.957168478907979*^9, 3.9571685912565436`*^9}, {3.9571687217190385`*^9, 
    3.9571687242389355`*^9}, {3.9571687803767767`*^9, 
    3.9571688639156613`*^9}, {3.9571689893729515`*^9, 
    3.9571690179135404`*^9}, {3.957169088865106*^9, 3.957169104365032*^9}, {
    3.9571693734272175`*^9, 3.957169465624623*^9}, {3.957169544136488*^9, 
    3.9571695495144215`*^9}, {3.957169830015744*^9, 3.957169842749343*^9}, {
    3.957169998902274*^9, 3.957170133887292*^9}, {3.9571701783610973`*^9, 
    3.9571702557026186`*^9}, {3.957170510874618*^9, 3.957170548159157*^9}, {
    3.9571707534935226`*^9, 3.9571707541519337`*^9}, {3.957171374272787*^9, 
    3.9571713763886275`*^9}, {3.9571715203371563`*^9, 
    3.9571715344963923`*^9}, {3.9571715646201124`*^9, 3.957171641991712*^9}, {
    3.957171719182576*^9, 3.957171749907152*^9}, {3.957171804228082*^9, 
    3.957171806569125*^9}, 3.9571718704746275`*^9, {3.957171952003688*^9, 
    3.9571719521385813`*^9}, {3.9571720638977423`*^9, 3.957172080422122*^9}, {
    3.9571733535376067`*^9, 3.957173358600973*^9}, {3.9571733919919386`*^9, 
    3.957173395759247*^9}, {3.957173505958381*^9, 3.957173524297681*^9}, {
    3.95717358186709*^9, 3.9571736712013893`*^9}, {3.957173764877982*^9, 
    3.9571737896319*^9}, {3.9571738198388047`*^9, 3.957173847715577*^9}, {
    3.9571738889563417`*^9, 3.957173889764689*^9}, {3.957174013820868*^9, 
    3.957174019475267*^9}, {3.9571740532704926`*^9, 3.95717405380604*^9}, {
    3.957174131225661*^9, 3.9571741402483516`*^9}, {3.95717475593443*^9, 
    3.9571747563486533`*^9}, {3.9572145445003977`*^9, 
    3.9572145468267727`*^9}, {3.9572182526848245`*^9, 
    3.9572182626798477`*^9}, {3.9572192861122446`*^9, 3.957219382190755*^9}, {
    3.95722557672433*^9, 3.9572255791031694`*^9}, {3.9572302045605974`*^9, 
    3.957230204784874*^9}, {3.9572325230281677`*^9, 3.9572325404044013`*^9}, {
    3.9574242320109477`*^9, 3.9574242364407454`*^9}, {3.9574680930630817`*^9, 
    3.9574680934483833`*^9}, {3.9574758709069223`*^9, 3.957475871432787*^9}, {
    3.9575051986562324`*^9, 3.9575051990335703`*^9}, {3.9575172118428335`*^9, 
    3.95751721217233*^9}, {3.957569655074523*^9, 3.95756965529618*^9}, {
    3.9575760837184067`*^9, 3.9575760840372243`*^9}, {3.957643608265041*^9, 
    3.957643608853529*^9}, {3.957661929304307*^9, 3.9576619294884806`*^9}, {
    3.957721645443865*^9, 3.957721645829754*^9}, {3.9577413054930267`*^9, 
    3.957741305593648*^9}, {3.9577602191452217`*^9, 3.9577602229993773`*^9}, 
    3.957760258259962*^9, {3.9578075583756676`*^9, 3.9578075613754807`*^9}, {
    3.9578324891796303`*^9, 3.9578324894212875`*^9}, {3.9578514428198256`*^9, 
    3.9578514430985627`*^9}, {3.957905901535838*^9, 3.9579059034720993`*^9}, {
    3.957906046138204*^9, 3.9579060466058936`*^9}, {3.958202069783778*^9, 
    3.9582020736733665`*^9}, {3.973583285798888*^9, 3.9735832859059296`*^9}, {
    3.973583909521531*^9, 3.9735839095730333`*^9}, {3.973584328224471*^9, 
    3.973584328280898*^9}, {3.9735846079482803`*^9, 3.9735846089213524`*^9}, {
    3.9735846687085967`*^9, 3.973584725944625*^9}, {3.973584998660328*^9, 
    3.9735850015571785`*^9}, {3.974262523684062*^9, 3.974262550661206*^9}, 
    3.9750562772156506`*^9, {3.975056804411849*^9, 3.9750568047048273`*^9}, {
    3.975056919491023*^9, 3.9750569260589643`*^9}, {3.9750631814193254`*^9, 
    3.9750631820609713`*^9}, {3.975093630689657*^9, 3.975093630824641*^9}, {
    3.9751071170454698`*^9, 3.975107117310058*^9}, {3.975132909054817*^9, 
    3.9751329091470785`*^9}, {3.975136841479034*^9, 3.9751368524248066`*^9}, {
    3.975141445619957*^9, 3.975141446140789*^9}, {3.9751690125293283`*^9, 
    3.9751690133192434`*^9}, {3.9751763069345417`*^9, 
    3.9751763072459717`*^9}, {3.9752126875761166`*^9, 3.975212687685747*^9}, {
    3.9752178205154505`*^9, 3.9752178229638186`*^9}, {3.975226663728011*^9, 
    3.9752266642149982`*^9}, {3.9752326243530655`*^9, 3.975232624510539*^9}, {
    3.975261920990927*^9, 3.975261921201217*^9}, {3.9752691461795044`*^9, 
    3.9752691484359083`*^9}, {3.9752749535158467`*^9, 
    3.9752749538766613`*^9}, {3.975284308227299*^9, 3.975284308609645*^9}, {
    3.975289412002921*^9, 3.9752894121534176`*^9}, {3.975295623075131*^9, 
    3.975295625062713*^9}, {3.975305940609538*^9, 3.9753059407878027`*^9}, {
    3.975311698281192*^9, 3.9753117031001773`*^9}, {3.975317226436745*^9, 
    3.97531722682977*^9}, {3.975350326721467*^9, 3.9753503271147413`*^9}, {
    3.9753607710171084`*^9, 3.9753607740525165`*^9}, {3.9753714224664755`*^9, 
    3.975371422574362*^9}, {3.9753951606104484`*^9, 3.9753951630943403`*^9}, {
    3.975412664504738*^9, 3.9754126648703313`*^9}, {3.975469919904792*^9, 
    3.9754699199247527`*^9}, {3.97547588097383*^9, 3.9754758812096233`*^9}, {
    3.9755267637040195`*^9, 3.9755267637587433`*^9}, {3.9755316672832875`*^9, 
    3.975531682266079*^9}, {3.9755371953194246`*^9, 3.975537195655155*^9}, {
    3.9755439474381576`*^9, 3.975543947598734*^9}, {3.975555537929798*^9, 
    3.975555538336054*^9}, {3.9755616894624295`*^9, 3.975561689524208*^9}, {
    3.975568392841753*^9, 3.975568394963889*^9}, {3.9755724956415052`*^9, 
    3.975572496989444*^9}, {3.975603578376444*^9, 3.9756035784921093`*^9}, {
    3.975609054956176*^9, 3.9756090551512403`*^9}, {3.9756394668819785`*^9, 
    3.975639467009555*^9}, {3.9756444651832066`*^9, 3.975644469452668*^9}, {
    3.97564840152319*^9, 3.9756484022096863`*^9}, {3.975653964662733*^9, 
    3.9756539647334957`*^9}, {3.9756587226689987`*^9, 
    3.9756587229332247`*^9}, {3.975679866077001*^9, 3.9756798662524147`*^9}, {
    3.9765197898874297`*^9, 3.9765198004337645`*^9}, {3.976520084889516*^9, 
    3.976520085361278*^9}},ExpressionUUID->
  "5fd22da0-e7d1-4bf1-8558-8a58cf467100"],
 ") obtained from the previous module to ",
 StyleBox["pointx",
  FontSize->16,
  FontWeight->"Bold"],
 " and ",
 StyleBox["pointy",
  FontSize->16,
  FontWeight->"Bold"],
 ". This initial guess is required for solving the equations (",
 Cell[BoxData[
  RowBox[{
   RowBox[{"\[PartialD]", 
    SubscriptBox["v", "eff"]}], "/", 
   RowBox[{"\[PartialD]", "r"}]}]],
  CellChangeTimes->{{3.9571667242857456`*^9, 3.957166779129676*^9}, {
    3.957166831634246*^9, 3.957166859348877*^9}, {3.957166989411211*^9, 
    3.957167008200284*^9}, {3.9571670513388357`*^9, 3.9571671273218117`*^9}, {
    3.9571671758101606`*^9, 3.957167292265072*^9}, {3.957167389706868*^9, 
    3.9571674886639767`*^9}, {3.957167520963458*^9, 3.9571675463169775`*^9}, {
    3.9571676858816566`*^9, 3.957167846126298*^9}, {3.957167915140493*^9, 
    3.957167939644196*^9}, {3.9571679850308456`*^9, 3.957167991677231*^9}, {
    3.957168049845221*^9, 3.957168052268364*^9}, {3.957168096102919*^9, 
    3.957168179388928*^9}, {3.9571683117917247`*^9, 3.957168329173957*^9}, {
    3.957168478907979*^9, 3.9571685912565436`*^9}, {3.9571687217190385`*^9, 
    3.9571687242389355`*^9}, {3.9571687803767767`*^9, 
    3.9571688639156613`*^9}, {3.9571689893729515`*^9, 
    3.9571690179135404`*^9}, {3.957169088865106*^9, 3.957169104365032*^9}, {
    3.9571693734272175`*^9, 3.957169465624623*^9}, {3.957169544136488*^9, 
    3.9571695495144215`*^9}, {3.957169830015744*^9, 3.957169842749343*^9}, {
    3.957169998902274*^9, 3.957170133887292*^9}, {3.9571701783610973`*^9, 
    3.9571702557026186`*^9}, {3.957170510874618*^9, 3.957170548159157*^9}, {
    3.9571707534935226`*^9, 3.9571707541519337`*^9}, {3.957171374272787*^9, 
    3.9571713763886275`*^9}, {3.9571715203371563`*^9, 
    3.9571715344963923`*^9}, {3.9571715646201124`*^9, 3.957171641991712*^9}, {
    3.957171719182576*^9, 3.957171749907152*^9}, {3.957171804228082*^9, 
    3.957171806569125*^9}, 3.9571718704746275`*^9, {3.957171952003688*^9, 
    3.9571719521385813`*^9}, {3.9571720638977423`*^9, 3.957172080422122*^9}, {
    3.9571733535376067`*^9, 3.957173358600973*^9}, {3.9571733919919386`*^9, 
    3.957173395759247*^9}, {3.957173505958381*^9, 3.957173524297681*^9}, {
    3.95717358186709*^9, 3.9571736712013893`*^9}, {3.957173764877982*^9, 
    3.9571737896319*^9}, {3.9571738198388047`*^9, 3.957173847715577*^9}, {
    3.9571738889563417`*^9, 3.957173889764689*^9}, {3.957174013820868*^9, 
    3.957174019475267*^9}, {3.9571740532704926`*^9, 3.95717405380604*^9}, {
    3.957174131225661*^9, 3.9571741402483516`*^9}, {3.95717475593443*^9, 
    3.9571747563486533`*^9}, {3.9572145445003977`*^9, 
    3.9572145468267727`*^9}, {3.9572182526848245`*^9, 
    3.9572182626798477`*^9}, {3.9572192861122446`*^9, 3.957219382190755*^9}, {
    3.95722557672433*^9, 3.9572255791031694`*^9}, {3.9572302045605974`*^9, 
    3.957230204784874*^9}, {3.9572325230281677`*^9, 3.9572325404044013`*^9}, {
    3.9574242320109477`*^9, 3.9574242364407454`*^9}, {3.9574680930630817`*^9, 
    3.9574680934483833`*^9}, {3.9574758709069223`*^9, 3.957475871432787*^9}, {
    3.9575051986562324`*^9, 3.9575051990335703`*^9}, {3.9575172118428335`*^9, 
    3.95751721217233*^9}, {3.957569655074523*^9, 3.95756965529618*^9}, {
    3.9575760837184067`*^9, 3.9575760840372243`*^9}, {3.957643608265041*^9, 
    3.957643608853529*^9}, {3.957661929304307*^9, 3.9576619294884806`*^9}, {
    3.957721645443865*^9, 3.957721645829754*^9}, {3.9577413054930267`*^9, 
    3.957741305593648*^9}, {3.9577602191452217`*^9, 3.9577602229993773`*^9}, 
    3.957760258259962*^9, {3.9578075583756676`*^9, 3.9578075613754807`*^9}, {
    3.9578324891796303`*^9, 3.9578324894212875`*^9}, {3.9578514428198256`*^9, 
    3.9578514430985627`*^9}, {3.957905901535838*^9, 3.9579059034720993`*^9}, {
    3.957906046138204*^9, 3.9579060466058936`*^9}, {3.958202069783778*^9, 
    3.9582020736733665`*^9}, {3.973583285798888*^9, 3.9735832859059296`*^9}, {
    3.973583909521531*^9, 3.9735839095730333`*^9}, {3.973584328224471*^9, 
    3.973584328280898*^9}, {3.9735846079482803`*^9, 3.9735846089213524`*^9}, {
    3.9735846687085967`*^9, 3.973584725944625*^9}, {3.973584998660328*^9, 
    3.9735850015571785`*^9}, {3.974262523684062*^9, 3.974262550661206*^9}, 
    3.9750562772156506`*^9, {3.975056804411849*^9, 3.9750568047048273`*^9}, {
    3.975056919491023*^9, 3.9750569260589643`*^9}, {3.9750631814193254`*^9, 
    3.9750631820609713`*^9}, {3.975093630689657*^9, 3.975093630824641*^9}, {
    3.9751071170454698`*^9, 3.975107117310058*^9}, {3.975132909054817*^9, 
    3.9751329091470785`*^9}, {3.975136841479034*^9, 3.9751368524248066`*^9}, {
    3.975141445619957*^9, 3.975141446140789*^9}, {3.9751690125293283`*^9, 
    3.9751690133192434`*^9}, {3.9751763069345417`*^9, 
    3.9751763072459717`*^9}, {3.9752126875761166`*^9, 3.975212687685747*^9}, {
    3.9752178205154505`*^9, 3.9752178229638186`*^9}, {3.975226663728011*^9, 
    3.9752266642149982`*^9}, {3.9752326243530655`*^9, 3.975232624510539*^9}, {
    3.975261920990927*^9, 3.975261921201217*^9}, {3.9752691461795044`*^9, 
    3.9752691484359083`*^9}, {3.9752749535158467`*^9, 
    3.9752749538766613`*^9}, {3.975284308227299*^9, 3.975284308609645*^9}, {
    3.975289412002921*^9, 3.9752894121534176`*^9}, {3.975295623075131*^9, 
    3.975295625062713*^9}, {3.975305940609538*^9, 3.9753059407878027`*^9}, {
    3.975311698281192*^9, 3.9753117031001773`*^9}, {3.975317226436745*^9, 
    3.97531722682977*^9}, {3.975350326721467*^9, 3.9753503271147413`*^9}, {
    3.9753607710171084`*^9, 3.9753607740525165`*^9}, {3.9753714224664755`*^9, 
    3.975371422574362*^9}, {3.9753951606104484`*^9, 3.9753951630943403`*^9}, {
    3.975412664504738*^9, 3.9754126648703313`*^9}, {3.975469919904792*^9, 
    3.9754699199247527`*^9}, {3.97547588097383*^9, 3.9754758812096233`*^9}, {
    3.9755267637040195`*^9, 3.9755267637587433`*^9}, {3.9755316672832875`*^9, 
    3.975531682266079*^9}, {3.9755371953194246`*^9, 3.975537195655155*^9}, {
    3.9755439474381576`*^9, 3.975543947598734*^9}, {3.975555537929798*^9, 
    3.975555538336054*^9}, {3.9755616894624295`*^9, 3.975561689524208*^9}, {
    3.975568392841753*^9, 3.975568394963889*^9}, {3.9755724956415052`*^9, 
    3.975572496989444*^9}, {3.975603578376444*^9, 3.9756035784921093`*^9}, {
    3.975609054956176*^9, 3.9756090551512403`*^9}, {3.9756394668819785`*^9, 
    3.975639467009555*^9}, {3.9756444651832066`*^9, 3.975644469452668*^9}, {
    3.97564840152319*^9, 3.9756484022096863`*^9}, {3.975653964662733*^9, 
    3.9756539647334957`*^9}, {3.9756587226689987`*^9, 
    3.9756587229332247`*^9}, {3.975679866077001*^9, 3.9756798662524147`*^9}, {
    3.9765197898874297`*^9, 3.9765198004337645`*^9}, {3.976520084889516*^9, 
    3.976520085361278*^9}},ExpressionUUID->
  "959e4039-6356-409d-8ecb-08a04979e799"],
 " =",
 Cell[BoxData[
  RowBox[{" ", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["\[PartialD]", "2"], 
      SubscriptBox["v", "eff"]}], "/", 
     RowBox[{"\[PartialD]", 
      SuperscriptBox["r", "2"]}]}], "=", "0"}]}]],
  CellChangeTimes->{{3.9571667242857456`*^9, 3.957166779129676*^9}, {
    3.957166831634246*^9, 3.957166859348877*^9}, {3.957166989411211*^9, 
    3.957167008200284*^9}, {3.9571670513388357`*^9, 3.9571671273218117`*^9}, {
    3.9571671758101606`*^9, 3.957167292265072*^9}, {3.957167389706868*^9, 
    3.9571674886639767`*^9}, {3.957167520963458*^9, 3.9571675463169775`*^9}, {
    3.9571676858816566`*^9, 3.957167846126298*^9}, {3.957167915140493*^9, 
    3.957167939644196*^9}, {3.9571679850308456`*^9, 3.957167991677231*^9}, {
    3.957168049845221*^9, 3.957168052268364*^9}, {3.957168096102919*^9, 
    3.957168179388928*^9}, {3.9571683117917247`*^9, 3.957168329173957*^9}, {
    3.957168478907979*^9, 3.9571685912565436`*^9}, {3.9571687217190385`*^9, 
    3.9571687242389355`*^9}, {3.9571687803767767`*^9, 
    3.9571688639156613`*^9}, {3.9571689893729515`*^9, 
    3.9571690179135404`*^9}, {3.957169088865106*^9, 3.957169104365032*^9}, {
    3.9571693734272175`*^9, 3.957169465624623*^9}, {3.957169544136488*^9, 
    3.9571695495144215`*^9}, {3.957169830015744*^9, 3.957169842749343*^9}, {
    3.957169998902274*^9, 3.957170133887292*^9}, {3.9571701783610973`*^9, 
    3.9571702557026186`*^9}, {3.957170510874618*^9, 3.957170548159157*^9}, {
    3.9571707534935226`*^9, 3.9571707541519337`*^9}, {3.957171374272787*^9, 
    3.9571713763886275`*^9}, {3.9571715203371563`*^9, 
    3.9571715344963923`*^9}, {3.9571715646201124`*^9, 3.957171641991712*^9}, {
    3.957171719182576*^9, 3.957171749907152*^9}, {3.957171804228082*^9, 
    3.957171806569125*^9}, 3.9571718704746275`*^9, {3.957171952003688*^9, 
    3.9571719521385813`*^9}, {3.9571720638977423`*^9, 3.957172080422122*^9}, {
    3.9571733535376067`*^9, 3.957173358600973*^9}, {3.9571733919919386`*^9, 
    3.957173395759247*^9}, {3.957173505958381*^9, 3.957173524297681*^9}, {
    3.95717358186709*^9, 3.9571736712013893`*^9}, {3.957173764877982*^9, 
    3.9571737896319*^9}, {3.9571738198388047`*^9, 3.957173847715577*^9}, {
    3.9571738889563417`*^9, 3.957173889764689*^9}, {3.957174013820868*^9, 
    3.957174019475267*^9}, {3.9571740532704926`*^9, 3.95717405380604*^9}, {
    3.957174131225661*^9, 3.9571741402483516`*^9}, {3.95717475593443*^9, 
    3.9571747563486533`*^9}, {3.9572145445003977`*^9, 
    3.9572145468267727`*^9}, {3.9572182526848245`*^9, 
    3.9572182626798477`*^9}, {3.9572192861122446`*^9, 3.957219382190755*^9}, {
    3.95722557672433*^9, 3.9572255791031694`*^9}, {3.9572302045605974`*^9, 
    3.957230204784874*^9}, {3.9572325230281677`*^9, 3.9572325404044013`*^9}, {
    3.9574242320109477`*^9, 3.9574242364407454`*^9}, {3.9574680930630817`*^9, 
    3.9574680934483833`*^9}, {3.9574758709069223`*^9, 3.957475871432787*^9}, {
    3.9575051986562324`*^9, 3.9575051990335703`*^9}, {3.9575172118428335`*^9, 
    3.95751721217233*^9}, {3.957569655074523*^9, 3.95756965529618*^9}, {
    3.9575760837184067`*^9, 3.9575760840372243`*^9}, {3.957643608265041*^9, 
    3.957643608853529*^9}, {3.957661929304307*^9, 3.9576619294884806`*^9}, {
    3.957721645443865*^9, 3.957721645829754*^9}, {3.9577413054930267`*^9, 
    3.957741305593648*^9}, {3.9577602191452217`*^9, 3.9577602229993773`*^9}, 
    3.957760258259962*^9, {3.9578075583756676`*^9, 3.9578075613754807`*^9}, {
    3.9578324891796303`*^9, 3.9578324894212875`*^9}, {3.9578514428198256`*^9, 
    3.9578514430985627`*^9}, {3.957905901535838*^9, 3.9579059034720993`*^9}, {
    3.957906046138204*^9, 3.9579060466058936`*^9}, {3.958202069783778*^9, 
    3.9582020736733665`*^9}, {3.973583285798888*^9, 3.9735832859059296`*^9}, {
    3.973583909521531*^9, 3.9735839095730333`*^9}, {3.973584328224471*^9, 
    3.973584328280898*^9}, {3.9735846079482803`*^9, 3.9735846089213524`*^9}, {
    3.9735846687085967`*^9, 3.973584725944625*^9}, {3.973584998660328*^9, 
    3.9735850015571785`*^9}, {3.974262523684062*^9, 3.974262550661206*^9}, 
    3.9750562772156506`*^9, {3.975056804411849*^9, 3.9750568047048273`*^9}, {
    3.975056919491023*^9, 3.9750569260589643`*^9}, {3.9750631814193254`*^9, 
    3.9750631820609713`*^9}, {3.975093630689657*^9, 3.975093630824641*^9}, {
    3.9751071170454698`*^9, 3.975107117310058*^9}, {3.975132909054817*^9, 
    3.9751329091470785`*^9}, {3.975136841479034*^9, 3.9751368524248066`*^9}, {
    3.975141445619957*^9, 3.975141446140789*^9}, {3.9751690125293283`*^9, 
    3.9751690133192434`*^9}, {3.9751763069345417`*^9, 
    3.9751763072459717`*^9}, {3.9752126875761166`*^9, 3.975212687685747*^9}, {
    3.9752178205154505`*^9, 3.9752178229638186`*^9}, {3.975226663728011*^9, 
    3.9752266642149982`*^9}, {3.9752326243530655`*^9, 3.975232624510539*^9}, {
    3.975261920990927*^9, 3.975261921201217*^9}, {3.9752691461795044`*^9, 
    3.9752691484359083`*^9}, {3.9752749535158467`*^9, 
    3.9752749538766613`*^9}, {3.975284308227299*^9, 3.975284308609645*^9}, {
    3.975289412002921*^9, 3.9752894121534176`*^9}, {3.975295623075131*^9, 
    3.975295625062713*^9}, {3.975305940609538*^9, 3.9753059407878027`*^9}, {
    3.975311698281192*^9, 3.9753117031001773`*^9}, {3.975317226436745*^9, 
    3.97531722682977*^9}, {3.975350326721467*^9, 3.9753503271147413`*^9}, {
    3.9753607710171084`*^9, 3.9753607740525165`*^9}, {3.9753714224664755`*^9, 
    3.975371422574362*^9}, {3.9753951606104484`*^9, 3.9753951630943403`*^9}, {
    3.975412664504738*^9, 3.9754126648703313`*^9}, {3.975469919904792*^9, 
    3.9754699199247527`*^9}, {3.97547588097383*^9, 3.9754758812096233`*^9}, {
    3.9755267637040195`*^9, 3.9755267637587433`*^9}, {3.9755316672832875`*^9, 
    3.975531682266079*^9}, {3.9755371953194246`*^9, 3.975537195655155*^9}, {
    3.9755439474381576`*^9, 3.975543947598734*^9}, {3.975555537929798*^9, 
    3.975555538336054*^9}, {3.9755616894624295`*^9, 3.975561689524208*^9}, {
    3.975568392841753*^9, 3.975568394963889*^9}, {3.9755724956415052`*^9, 
    3.975572496989444*^9}, {3.975603578376444*^9, 3.9756035784921093`*^9}, {
    3.975609054956176*^9, 3.9756090551512403`*^9}, {3.9756394668819785`*^9, 
    3.975639467009555*^9}, {3.9756444651832066`*^9, 3.975644469452668*^9}, {
    3.97564840152319*^9, 3.9756484022096863`*^9}, {3.975653964662733*^9, 
    3.9756539647334957`*^9}, {3.9756587226689987`*^9, 
    3.9756587229332247`*^9}, {3.975679866077001*^9, 3.9756798662524147`*^9}, {
    3.9765197898874297`*^9, 3.9765198004337645`*^9}, {3.976520084889516*^9, 
    3.976520085361278*^9}},ExpressionUUID->
  "271d5e31-0a8f-42ba-b894-9da1c876d349"],
 ") using the iterative method."
}], "Text",
 CellChangeTimes->{{3.976520110789811*^9, 3.9765201493888206`*^9}, {
  3.976520232767926*^9, 3.97652030234056*^9}, {3.9765203472491345`*^9, 
  3.9765204003591022`*^9}, {3.976522625878601*^9, 3.9765227649810715`*^9}, {
  3.976522807553331*^9, 
  3.9765228109121337`*^9}},ExpressionUUID->"f0522813-03d9-4cb2-aeaf-\
e41adeb4bc2d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pointx", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointy", "=", "3.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"solution", "=", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dveff", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "==", "0"}], ",", 
      RowBox[{
       RowBox[{"ddveff", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "==", "0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "pointx"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "pointy"}], "}"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"radius", ",", "momentum"}], "}"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "/.", " ", "solution"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"dveff", "[", 
  RowBox[{"radius", ",", "momentum"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ddveff", "[", 
  RowBox[{"radius", ",", "momentum"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"veff", "/.", 
    RowBox[{"P", "->", "momentum"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"r", ",", 
     RowBox[{"reh", "+", "0.001"}], ",", "15"}], "}"}], ",", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "15"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1.5"}], "}"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isco", "=", 
   RowBox[{"radius", "+", "0.001"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edge", "=", "40"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwlznlMknEcx3GSaGaaGZjkpmmac9XKNgslIp/yGNlcUYY2KDJwhZR2r9K0
7ECnjpyGx4NEy9kcdlhahraOuZJMO0zzotlJ5WMHma5rfb+//vjs9d9n78CU
dKnahcViLYOhTZ3SddcOMxTPdWgDuk08X42e9BwkRu1csQtNSdpKfGOyZ6GD
P3uOo+515fmoW0+9Hh2oHqhElbciaZRfWehERd7cX+ilnBxWA/hqcwEbdWSM
TkGrnBV8tFV872YbuNsn0Ioq7+TN6QS5cfNC0LKxJO1T0H+fgSiUco6hqbV+
RG2jRvAMjC7miNDXD9Zr0HdrGom+O5uDwzIZqlionIMeqco4GAMuUZgyUX6B
t0QC9l4PI252fKdl4JYYLyNRrj+lACMSw3VomvyLzwGwPruWj+714AkO4Y/V
QlwYagivBB+bFy1GN07KCD4PVvOcRKFzofkOmFgwSMzlzHpnA3nuJmLCn67Z
XWAJTx2E9r2NFn8CYzXvieZyOm0MPMOTa1FhR9RVVhZDrdUdaEAD7EORLpUM
VRchF6IXbSfzUbX1BZH/4Wsz2ivNbkFvFjkYNL00awRt8V/uxQZlKaeItCA2
KIFmKPHE28T2VeMPnhgZStehbUObudbuLtD1/eN+VBXDlnwEXRTbiL/nlQ79
AEssR1+hlOV1+zioHFA+Qn3vc3JdqxgqdFkIsbbJw8sdtKk8iaOmpud+YHRq
cDcalLdAFgDK9u4hOjrPvVwM3l1TQ7zBm6mNBA12+w40QMJPEoE/1G7J6Cz9
tfiVYJGxm1g9mZscC9L8RmKfilbEgy0GziZUyY2bnwBapuqJk644ZGngxMK/
xAUn+of3g5drhAyqK1PmPsReQet/7dMEI+DwjJAIlM4/feEL6GcxE+dOXxo/
CqaP7COybTbjGFih6iD6C7d/m2BiqI8+q52oqEEjos8y1OeS+yvRf4qc+hk=

  "],
 CellLabel->"In[28]:=",ExpressionUUID->"e3387f3e-56c0-4e89-9202-7d265825a5d9"],

Cell[TextData[{
 "Define the specific angular momentum ",
 StyleBox["sco[x]",
  FontWeight->"Bold"],
 "\:ff0cthe specific energy ",
 StyleBox["potential[x]",
  FontWeight->"Bold"],
 ", and the angular velocity ",
 StyleBox["\[CapitalOmega][x]",
  FontWeight->"Bold"],
 " for circular orbits."
}], "Text",
 CellChangeTimes->{{3.9765204115358486`*^9, 3.976520416368368*^9}, {
  3.9765204568046513`*^9, 3.9765204886898556`*^9}, {3.976522900832367*^9, 
  3.9765229684777417`*^9}},ExpressionUUID->"b78f07f4-42eb-4456-9310-\
f8ce86a721ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sco", "[", "x_", "]"}], ":=", 
   RowBox[{"y", "/.", 
    RowBox[{"First", "@", 
     RowBox[{"NSolve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"dveff", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "==", "0"}], "&&", 
        RowBox[{
         RowBox[{"ddveff", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "\[GreaterSlantEqual]", "0"}], "&&", 
        RowBox[{"y", ">", "0"}]}], ",", "y", ",", "Reals"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"potential", "[", "x_", "]"}], ":=", 
   RowBox[{"veff", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "->", "x"}], ",", 
      RowBox[{"P", "->", 
       RowBox[{"sco", "[", "x", "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"f2", "\[Times]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"potential", "[", "x", "]"}], "+", 
         SubscriptBox["A", "t"]}], ")"}]}], "+", 
      RowBox[{"f3", "\[Times]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sco", "[", "x", "]"}], "-", 
         SubscriptBox["A", "\[Phi]"]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "f1"}], "\[Times]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"potential", "[", "x", "]"}], "+", 
         SubscriptBox["A", "t"]}], ")"}]}], "-", 
      RowBox[{"f2", "\[Times]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sco", "[", "x", "]"}], "-", 
         SubscriptBox["A", "\[Phi]"]}], ")"}]}]}], ")"}]}], "/.", 
   RowBox[{"r", "->", "x"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xvalues", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"isco", ",", "edge", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"edge", "-", "isco"}], ")"}], "/", "2000"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Length", "[", "xvalues", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"angularmomentum", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xval", ",", 
         RowBox[{"sco", "[", "xval", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"xval", ",", "xvalues"}], "}"}]}], "]"}], ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{
       RowBox[{"Dynamic", "[", "xval", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"isco", ",", "edge"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "Print", "[", "\"\<Angular momentum calculation completed.\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energy", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xval", "=", 
            RowBox[{"angularmomentum", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"sval", "=", 
            RowBox[{"angularmomentum", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"xval", ",", 
           RowBox[{"veff", "/.", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"r", "->", "xval"}], ",", 
              RowBox[{"P", "->", "sval"}]}], "}"}]}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{
       RowBox[{"Dynamic", "[", "xval", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"isco", ",", "edge"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Energy calculation completed.\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"angularvelocity", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xval", "=", 
            RowBox[{"angularmomentum", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"sval", "=", 
            RowBox[{"angularmomentum", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
           RowBox[{"pval", "=", 
            RowBox[{"energy", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"xval", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"f2", "\[Times]", 
                RowBox[{"(", 
                 RowBox[{"pval", "+", 
                  SubscriptBox["A", "t"]}], ")"}]}], "+", 
               RowBox[{"f3", "\[Times]", 
                RowBox[{"(", 
                 RowBox[{"sval", "-", 
                  SubscriptBox["A", "\[Phi]"]}], ")"}]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "f1"}], "\[Times]", 
                RowBox[{"(", 
                 RowBox[{"pval", "+", 
                  SubscriptBox["A", "t"]}], ")"}]}], "-", 
               RowBox[{"f2", "\[Times]", 
                RowBox[{"(", 
                 RowBox[{"sval", "-", 
                  SubscriptBox["A", "\[Phi]"]}], ")"}]}]}], ")"}]}], "/.", 
            RowBox[{"r", "->", "xval"}]}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{
       RowBox[{"Dynamic", "[", "xval", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"isco", ",", "edge"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "Print", "[", "\"\<Angular velocity calculation completed.\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.957213945767541*^9, 3.9572140089713783`*^9}, {
   3.9572140398231187`*^9, 3.957214041116807*^9}, {3.9572140941845737`*^9, 
   3.957214095382408*^9}, {3.957214287161666*^9, 3.9572143487316275`*^9}, {
   3.9572143827272415`*^9, 3.9572144005237446`*^9}, 3.957214968146083*^9, 
   3.957216789472968*^9, {3.9572168214036894`*^9, 3.9572169201656523`*^9}, {
   3.9572169790283127`*^9, 3.9572169828579283`*^9}, {3.9572171464240265`*^9, 
   3.9572172810260525`*^9}, {3.9572175418136797`*^9, 3.957217548668574*^9}, {
   3.957217612176695*^9, 3.9572176421100845`*^9}, {3.9572177077056847`*^9, 
   3.9572177245554466`*^9}, {3.957217792792551*^9, 3.957217796371431*^9}, {
   3.957217852523673*^9, 3.9572178949256425`*^9}, {3.9572179614829383`*^9, 
   3.9572179665734177`*^9}, {3.9572180315878444`*^9, 3.957218034951662*^9}, {
   3.957219398173463*^9, 3.957219414757699*^9}, {3.957219458666467*^9, 
   3.9572195639962425`*^9}, {3.957219596508519*^9, 3.9572196346499476`*^9}, 
   3.957219917561465*^9, 3.9572380586386704`*^9, {3.9751072113539023`*^9, 
   3.975107215369432*^9}, {3.9751073109795322`*^9, 3.9751073910313525`*^9}, {
   3.975108112183689*^9, 3.9751082361103334`*^9}, {3.9751082758992386`*^9, 
   3.9751082762113285`*^9}, {3.9751083066769924`*^9, 
   3.9751083756429844`*^9}, {3.9751119432840033`*^9, 3.97511198327394*^9}, 
   3.975112037799945*^9, {3.9751122590838227`*^9, 3.975112259789243*^9}, {
   3.9765217298345985`*^9, 3.9765217325639505`*^9}, {3.976522558251928*^9, 
   3.976522559735321*^9}},ExpressionUUID->"470a58ae-704e-472b-96b9-\
d6f343e4ad68"],

Cell[TextData[{
 "Construct the interpolation functions for the specific angular momentum and \
angular velocity, and compute their discrete derivatives.\nThis module \
generates discrete data for the following five physical quantities: specific \
energy (",
 StyleBox["energy",
  FontWeight->"Bold"],
 "), specific angular momentum (",
 StyleBox["angularmomentum",
  FontWeight->"Bold"],
 "), angular velocity (",
 StyleBox["angularvelocity",
  FontWeight->"Bold"],
 "), and the radial derivatives of the latter two (",
 StyleBox["dldr",
  FontWeight->"Bold"],
 ", ",
 StyleBox["d\[CapitalOmega]dr",
  FontWeight->"Bold"],
 ")."
}], "Text",
 CellChangeTimes->{{3.976520599209141*^9, 3.976520780803345*^9}, {
  3.9765230794253283`*^9, 
  3.9765231770902863`*^9}},ExpressionUUID->"8ddc48ca-4dc4-4d31-bba4-\
c5fb706d3a3a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LInterpolation", "=", 
   RowBox[{"Interpolation", "[", "angularmomentum", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dL", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"LInterpolation", "'"}], "[", "x", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]Interpolation", "=", 
   RowBox[{"Interpolation", "[", "angularvelocity", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d\[CapitalOmega]", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[CapitalOmega]Interpolation", "'"}], "[", "x", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dldr", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"dL", "[", "x", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "isco", ",", "edge", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"edge", "-", "isco"}], ")"}], "/", "1000"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[CapitalOmega]dr", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"d\[CapitalOmega]", "[", "x", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "isco", ",", "edge", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"edge", "-", "isco"}], ")"}], "/", "1000"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"energy", ",", 
   RowBox[{"PlotStyle", "->", "Blue"}], ",", 
   RowBox[{"Mesh", "->", "All"}], ",", 
   RowBox[{"AxesLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<r\>\"", ",", "\"\<E\>\""}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"angularmomentum", ",", 
   RowBox[{"PlotStyle", "->", "Blue"}], ",", 
   RowBox[{"Mesh", "->", "All"}], ",", 
   RowBox[{"AxesLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<r\>\"", ",", "\"\<L\>\""}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"angularvelocity", ",", 
   RowBox[{"PlotStyle", "->", "Blue"}], ",", 
   RowBox[{"Mesh", "->", "All"}], ",", 
   RowBox[{"AxesLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<r\>\"", ",", "\"\<\[CapitalOmega]\>\""}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"dldr", ",", 
   RowBox[{"PlotStyle", "->", "Blue"}], ",", 
   RowBox[{"Mesh", "->", "All"}], ",", 
   RowBox[{"AxesLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<r\>\"", ",", "\"\<dL\>\""}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"d\[CapitalOmega]dr", ",", 
   RowBox[{"PlotStyle", "->", "Blue"}], ",", 
   RowBox[{"Mesh", "->", "All"}], ",", 
   RowBox[{"AxesLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<r\>\"", ",", "\"\<d\[CapitalOmega]\>\""}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<E.dat\>\"", ",", "energy", ",", "\"\<Table\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<L.dat\>\"", ",", "angularmomentum", ",", "\"\<Table\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<Omega.dat\>\"", ",", "angularvelocity", ",", "\"\<Table\>\""}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<dL.dat\>\"", ",", "dldr", ",", "\"\<Table\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<dOmega.dat\>\"", ",", "d\[CapitalOmega]dr", ",", "\"\<Table\>\""}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9572247964013715`*^9, 3.9572249762234564`*^9}, {
   3.9572253417813673`*^9, 3.957225497684332*^9}, {3.957234328211472*^9, 
   3.957234455182027*^9}, {3.9572377966064568`*^9, 3.957237900092416*^9}, {
   3.957240715586113*^9, 3.957240728118393*^9}, 3.976521658274969*^9},
 CellLabel->"In[48]:=",ExpressionUUID->"a66f6c14-45e6-4d19-b6a2-3c3315d822f2"],

Cell["\<\
Using the data computed in the previous module, construct interpolation \
functions.\
\>", "Text",
 CellChangeTimes->{{3.9765208264587574`*^9, 3.976520850666836*^9}, 
   3.9765232275441303`*^9},ExpressionUUID->"4bf6c929-7543-4111-aa10-\
0822575853e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"e", "=", 
   RowBox[{"Interpolation", "[", "energy", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l", "=", 
   RowBox[{"Interpolation", "[", "angularmomentum", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"o", "=", 
   RowBox[{"Interpolation", "[", "angularvelocity", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dl", "=", 
   RowBox[{"Interpolation", "[", "dldr", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"do", "=", 
   RowBox[{"Interpolation", "[", "d\[CapitalOmega]dr", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9572389499372826`*^9, 3.957238988390707*^9}, {
   3.957240449750944*^9, 3.9572405911840377`*^9}, {3.9572409155135813`*^9, 
   3.95724091697011*^9}, 3.957250942734083*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"e017806c-1047-4f66-b793-e5f4ecd16fd4"],

Cell[TextData[{
 "Convert from geometric units to Gaussian units.\nDefine the black hole mass \
and the accretion rate.\nThe black hole mass is expressed in units of ",
 StyleBox["solar masses",
  FontWeight->"Bold"],
 ", and the accretion rate in units of ",
 StyleBox["solar masses per year",
  FontWeight->"Bold"],
 "."
}], "Text",
 CellChangeTimes->{{3.9765208804754777`*^9, 3.9765209270259433`*^9}, 
   3.9765232505711927`*^9, {3.976523299202202*^9, 
   3.976523301959545*^9}},ExpressionUUID->"42fa41a1-fcde-49ed-a6b1-\
027dba67d859"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mass", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"accretion", "=", 
   RowBox[{"1", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "8"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"6.67", "\[Times]", 
    SuperscriptBox["10", 
     RowBox[{"-", "11"}]]}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    SuperscriptBox["m", "3"], "/", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["s", "2"], "kg"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"c", "=", "299792458"}], ";", 
  RowBox[{"(*", 
   FractionBox["m", "s"], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"msun", "=", 
   RowBox[{"1.989", "\[Times]", 
    SuperscriptBox["10", "30"]}]}], ";", 
  RowBox[{"(*", "kg", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"year", "=", 
   RowBox[{"365", "\[Times]", "24", "\[Times]", "3600"}]}], ";", 
  RowBox[{"(*", "s", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ratio", "=", 
   SuperscriptBox["10", "3"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coefficient", "=", 
   RowBox[{"accretion", "\[Times]", 
    RowBox[{"(", 
     RowBox[{"msun", "/", "year"}], ")"}], "\[Times]", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["c", "6"], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"G", "\[Times]", "mass", "\[Times]", "msun"}], ")"}], "2"]}], 
     ")"}], "\[Times]", "ratio"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"SI", " ", "to", " ", "Gauss"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Sigma]", "=", 
   RowBox[{"5.67", "\[Times]", 
    SuperscriptBox["10", 
     RowBox[{"-", "5"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Kappa]", "=", 
   RowBox[{"1.380649", "\[Times]", 
    SuperscriptBox["10", 
     RowBox[{"-", "23"}]], "\[Times]", 
    SuperscriptBox["10", "7"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{"6.6260693", "\[Times]", 
    SuperscriptBox["10", 
     RowBox[{"-", "34"}]], "\[Times]", 
    SuperscriptBox["10", "7"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inner", "=", "isco"}], ";"}]}], "Input",
 CellChangeTimes->{{3.957240947511692*^9, 3.9572409809084983`*^9}, {
   3.974266129428091*^9, 3.9742661587920856`*^9}, 3.9744368801284337`*^9, {
   3.9744452140078535`*^9, 3.9744452163716373`*^9}, {3.9744523705834537`*^9, 
   3.974452370654957*^9}, {3.974458109309512*^9, 3.97445811318451*^9}, {
   3.9744721489590316`*^9, 3.9744721490490513`*^9}, {3.9744919000027647`*^9, 
   3.9744919000918417`*^9}, 3.9744919629768243`*^9, {3.9745030818163786`*^9, 
   3.974503081949932*^9}, {3.9745124405824413`*^9, 3.9745124413472323`*^9}, {
   3.9745216146886487`*^9, 3.9745216147936335`*^9}, {3.974529348308772*^9, 
   3.9745293490516577`*^9}, {3.974536066609748*^9, 3.974536066691441*^9}, {
   3.975056294605133*^9, 3.975056327988818*^9}, {3.9750568276035037`*^9, 
   3.975056834394159*^9}, {3.9751347406839595`*^9, 3.9751347596154437`*^9}, {
   3.975274900768832*^9, 3.9752749175731497`*^9}, {3.9752749896676264`*^9, 
   3.975275035817589*^9}, {3.9752751271041784`*^9, 3.9752751354357605`*^9}, {
   3.9755316366827974`*^9, 3.975531641877179*^9}, {3.976521630988386*^9, 
   3.9765216329226136`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"f4f4ff50-a64c-41b7-aef5-78b62ebb4fb0"],

Cell["\<\
Calculate the energy flux density and temperature of the accretion disk.\
\>", "Text",
 CellChangeTimes->{{3.97652095830682*^9, 3.9765210376380615`*^9}, 
   3.9765233413263073`*^9},ExpressionUUID->"ce3a36dd-d3dc-452e-a022-\
39f965da1166"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"flux", "[", 
    RowBox[{"z_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "coefficient"}], "\[Times]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"do", "[", "z", "]"}], "/", 
      RowBox[{"(", 
       RowBox[{"4", "\[Times]", "\[Pi]", "\[Times]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"e", "[", "z", "]"}], "-", 
           RowBox[{
            RowBox[{"o", "[", "z", "]"}], "\[Times]", 
            RowBox[{"l", "[", "z", "]"}]}]}], ")"}], "2"], "\[Times]", "z"}], 
       ")"}]}], ")"}], "\[Times]", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"e", "[", "x", "]"}], "-", 
         RowBox[{
          RowBox[{"o", "[", "x", "]"}], "\[Times]", 
          RowBox[{"l", "[", "x", "]"}]}]}], ")"}], "\[Times]", 
       RowBox[{"dL", "[", "x", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "inner", ",", "z"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{"z_", "?", "NumericQ"}], "]"}], ":=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"flux", "[", "z", "]"}], "/", "\[Sigma]"}], ")"}], "0.25"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energyflux", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{"flux", "[", "z", "]"}], ",", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"flux", "[", "z", "]"}], "/", "\[Sigma]"}], ")"}], 
          "0.25"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "isco", ",", "edge", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"edge", "-", "isco"}], ")"}], "/", "1000"}]}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{
       RowBox[{"Dynamic", "[", "z", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"isco", ",", "edge"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Energy flux calculation completed.\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temperature", "=", 
   RowBox[{"energyflux", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Temperature calculation completed.\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"energyflux", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
   RowBox[{"PlotStyle", "->", "Blue"}], ",", 
   RowBox[{"Mesh", "->", "All"}], ",", 
   RowBox[{"AxesLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<r\>\"", ",", "\"\<Flux\>\""}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"temperature", ",", 
   RowBox[{"PlotStyle", "->", "Blue"}], ",", 
   RowBox[{"Mesh", "->", "All"}], ",", 
   RowBox[{"AxesLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<r\>\"", ",", "\"\<T[K]\>\""}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.95724141832053*^9, 3.9572414377465577`*^9}, {
   3.957242343111026*^9, 3.9572426816130853`*^9}, {3.957242712958813*^9, 
   3.9572427843220825`*^9}, {3.957243007974732*^9, 3.957243014223979*^9}, {
   3.9572435036239824`*^9, 3.9572435608993235`*^9}, {3.957243942849307*^9, 
   3.957243956832261*^9}, {3.957244421631514*^9, 3.957244656086174*^9}, {
   3.957250693638022*^9, 3.9572507017377234`*^9}, {3.9572507602149487`*^9, 
   3.9572507707991114`*^9}, {3.9572508982195916`*^9, 3.95725090092939*^9}, {
   3.957250937702075*^9, 3.9572509699880486`*^9}, {3.957427800529846*^9, 
   3.957427803898369*^9}, {3.9574283201972847`*^9, 3.9574283271636677`*^9}, {
   3.9574283575802774`*^9, 3.9574284003390207`*^9}, {3.957428631051916*^9, 
   3.957428631508868*^9}, {3.9574287121047573`*^9, 3.9574287443114476`*^9}, {
   3.957429682234247*^9, 3.957429685319141*^9}, {3.9574691601746798`*^9, 
   3.9574691618123064`*^9}, {3.973584855458331*^9, 3.9735848873615723`*^9}, {
   3.975825250355254*^9, 3.9758252509597864`*^9}, {3.9765210579851866`*^9, 
   3.9765210843873854`*^9}, 3.9765216155930114`*^9, {3.9765233688971853`*^9, 
   3.9765233843872986`*^9}},ExpressionUUID->"622f75be-24b9-4696-b0f8-\
b6cc7f6556f5"],

Cell[TextData[{
 "Construct the interpolation function for temperature.\nDefine the \
observation inclination angle \[Gamma]. \nCalculate the thermal luminosity of \
the accretion disk.\nThe observed frequency range is [vmin, vmax].\n",
 StyleBox["Note: During the later stages of computation, warnings may appear. \
This is acceptable because the NOTEBOOK have specified a sufficiently broad \
frequency range. For certain choices of black hole parameters, calculations \
at high frequencies may lead to non-physical results.",
  FontSize->16,
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.9765211372786818`*^9, 3.9765212492111855`*^9}, {
  3.976521358989086*^9, 3.9765214433885307`*^9}, {3.9765228585199547`*^9, 
  3.976522886200317*^9}, {3.9765234413802805`*^9, 3.9765235659176226`*^9}, {
  3.9765236536386642`*^9, 
  3.976523655495137*^9}},ExpressionUUID->"79fd9039-b748-4188-be05-\
f56dd32b8306"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vmin", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vmax", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dfreq", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"Interpolation", "[", "temperature", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"17", "/", "180"}], ")"}], "\[Times]", "\[Pi]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g", "[", "z_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"o", "[", "z", "]"}], "\[Times]", "r", "\[Times]", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], "\[Times]", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], ")"}], "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["g", "tt"]}], "-", 
       RowBox[{"2", "\[Times]", 
        RowBox[{"o", "[", "z", "]"}], "\[Times]", 
        SubscriptBox["g", "t\[Phi]"]}], "-", 
       RowBox[{
        RowBox[{"o", "[", "z", "]"}], "\[Times]", 
        RowBox[{"o", "[", "z", "]"}], "\[Times]", 
        SubscriptBox["g", "\[Phi]\[Phi]"]}]}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"r", "->", "z"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bright", "[", "\[Nu]_", "]"}], ":=", 
   RowBox[{"\[Nu]", "\[Times]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"8", "\[Times]", "\[Pi]", "\[Times]", "h", "\[Times]", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], ")"}], "/", 
      SuperscriptBox["c", "2"]}], ")"}], "\[Times]", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Nu]", "3"], "\[Times]", 
         RowBox[{"g", "[", "z", "]"}], "\[Times]", 
         RowBox[{"g", "[", "z", "]"}], "\[Times]", 
         RowBox[{"g", "[", "z", "]"}], "\[Times]", "z"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"h", "\[Times]", "\[Nu]", "\[Times]", 
             RowBox[{"g", "[", "z", "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"\[Kappa]", "\[Times]", 
             RowBox[{"t", "[", "z", "]"}]}], ")"}]}], "]"}], "-", "1"}], 
        ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "inner", ",", "edge"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "0", ",", 
        RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "\[Times]", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"G", "\[Times]", "msun"}], ")"}], "/", 
         SuperscriptBox["c", "2"]}], ")"}], "\[Times]", "mass"}], ")"}], 
     "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"luminosities", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", 
         RowBox[{"Log10", "[", 
          RowBox[{"bright", "[", 
           SuperscriptBox["10", "v"], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v", ",", "vmin", ",", "vmax", ",", "dfreq"}], "}"}]}], "]"}],
      ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{
       RowBox[{"Dynamic", "[", "v", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"vmin", ",", "vmax"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Luminosity calculation completed.\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<bright.dat\>\"", ",", "luminosities", ",", "\"\<Table\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<flux.dat\>\"", ",", "energyflux", ",", "\"\<Table\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<temperature.dat\>\"", ",", "temperature", ",", "\"\<Table\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"luminosities", ",", 
   RowBox[{"PlotStyle", "->", "Blue"}], ",", 
   RowBox[{"Mesh", "->", "All"}], ",", 
   RowBox[{"AxesLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<\[Nu]\>\"", ",", "\"\<Luminosity\>\""}], "}"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9572458038981047`*^9, 3.9572458359224844`*^9}, {
   3.9572463838336015`*^9, 3.9572465946938877`*^9}, {3.9572491366280913`*^9, 
   3.957249143502509*^9}, {3.9572491750353622`*^9, 3.9572491753111625`*^9}, {
   3.95724927615888*^9, 3.9572493217745895`*^9}, {3.957249396380743*^9, 
   3.957249442425147*^9}, {3.957249555110607*^9, 3.9572495791294804`*^9}, {
   3.957249979932444*^9, 3.957250048583993*^9}, {3.957250096446345*^9, 
   3.957250407044387*^9}, {3.9572504442364197`*^9, 3.9572504878891*^9}, {
   3.957250972200664*^9, 3.957250980751692*^9}, {3.957251100331728*^9, 
   3.9572511234374*^9}, {3.9572513027610216`*^9, 3.9572514486934557`*^9}, 
   3.9572532839082203`*^9, {3.957253340584072*^9, 3.9572534048608274`*^9}, {
   3.957254025560418*^9, 3.9572540258223724`*^9}, {3.9574241790147057`*^9, 
   3.957424196051873*^9}, {3.957428646352341*^9, 3.957428675234202*^9}, {
   3.9574304377500935`*^9, 3.9574304499185*^9}, {3.95743067049793*^9, 
   3.957430671151475*^9}, {3.957449062073203*^9, 3.9574490624993434`*^9}, {
   3.957471958176753*^9, 3.957471958357421*^9}, 3.957475293528521*^9, {
   3.957477737585622*^9, 3.9574777379141755`*^9}, {3.957479885876062*^9, 
   3.957479886183866*^9}, {3.9575126801468797`*^9, 3.9575126802745094`*^9}, 
   3.9575152158769307`*^9, 3.9575619206164837`*^9, {3.9575668734103627`*^9, 
   3.9575668738105893`*^9}, {3.957573166049328*^9, 3.957573166254139*^9}, 
   3.9575752263690634`*^9, 3.9576372893023453`*^9, {3.9576409681699123`*^9, 
   3.9576409685400386`*^9}, {3.9576554551829576`*^9, 3.95765545533272*^9}, 
   3.957658908631159*^9, {3.9576833814178486`*^9, 3.9576833823021913`*^9}, {
   3.957686151780076*^9, 3.957686151889045*^9}, {3.9577366781320343`*^9, 
   3.9577366782525363`*^9}, 3.95774061273668*^9, 3.957755463747794*^9, {
   3.9577574678326225`*^9, 3.9577574679325924`*^9}, {3.9577686220658274`*^9, 
   3.957768622179206*^9}, 3.957776133851735*^9, 3.957827789805045*^9, {
   3.9578302184740334`*^9, 3.9578302185943136`*^9}, {3.957845641305304*^9, 
   3.957845641393786*^9}, 3.9578485574796715`*^9, 3.95786048471259*^9, {
   3.957890814891675*^9, 3.95789081529709*^9}, {3.9735848724165707`*^9, 
   3.9735848788413363`*^9}, {3.97426698945494*^9, 3.974266992511259*^9}, {
   3.9742670461222796`*^9, 3.9742670771932573`*^9}, {3.9744919783392105`*^9, 
   3.9744919820644655`*^9}, {3.976521276541829*^9, 3.9765213049721346`*^9}, {
   3.9765218808834343`*^9, 3.9765218946615815`*^9}, {3.976523590885835*^9, 
   3.9765236223038654`*^9}},ExpressionUUID->"9e46d59f-3c27-4d72-a93e-\
9f691101cd1a"]
},
WindowSize->{2560, 1357},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
TaggingRules->Association[
 "TryRealOnly" -> False, "PresenterSettings" -> Association["Dialogs" -> {}]],
Magnification:>1.4 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (2021\:5e747\:670823\
\:65e5)",
StyleDefinitions->FrontEnd`FileName[{"PresenterTools"}, "Garnet.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"fe3e9ac6-eed1-4c6e-9b82-e6834018f8ad"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1676, 38, 221, "Text",ExpressionUUID->"8d341e95-62d5-4dcb-9d0b-20b99442642a"],
Cell[2237, 60, 14912, 359, 1041, "Input",ExpressionUUID->"3c374082-1d52-412d-8ef2-d0bf6ce40da6"],
Cell[17152, 421, 27226, 397, 106, "Text",ExpressionUUID->"f0522813-03d9-4cb2-aeaf-e41adeb4bc2d"],
Cell[44381, 820, 2808, 74, 303, "Input",ExpressionUUID->"e3387f3e-56c0-4e89-9202-7d265825a5d9"],
Cell[47192, 896, 533, 15, 43, "Text",ExpressionUUID->"b78f07f4-42eb-4456-9310-f8ce86a721ac"],
Cell[47728, 913, 7693, 203, 570, "Input",ExpressionUUID->"470a58ae-704e-472b-96b9-d6f343e4ad68"],
Cell[55424, 1118, 820, 24, 71, "Text",ExpressionUUID->"8ddc48ca-4dc4-4d31-bba4-c5fb706d3a3a"],
Cell[56247, 1144, 4083, 113, 767, "Input",ExpressionUUID->"a66f6c14-45e6-4d19-b6a2-3c3315d822f2"],
Cell[60333, 1259, 261, 6, 43, "Text",ExpressionUUID->"4bf6c929-7543-4111-aa10-0822575853e2"],
Cell[60597, 1267, 888, 24, 261, "Input",ExpressionUUID->"e017806c-1047-4f66-b793-e5f4ecd16fd4"],
Cell[61488, 1293, 539, 13, 98, "Text",ExpressionUUID->"42fa41a1-fcde-49ed-a6b1-027dba67d859"],
Cell[62030, 1308, 3306, 79, 367, "Input",ExpressionUUID->"f4f4ff50-a64c-41b7-aef5-78b62ebb4fb0"],
Cell[65339, 1389, 248, 5, 43, "Text",ExpressionUUID->"ce3a36dd-d3dc-452e-a022-39f965da1166"],
Cell[65590, 1396, 4507, 116, 423, "Input",ExpressionUUID->"622f75be-24b9-4696-b0f8-b6cc7f6556f5"],
Cell[70100, 1514, 911, 16, 185, "Text",ExpressionUUID->"79fd9039-b748-4188-be05-f56dd32b8306"],
Cell[71014, 1532, 6995, 162, 579, "Input",ExpressionUUID->"9e46d59f-3c27-4d72-a93e-9f691101cd1a"]
}
]
*)

